
<!DOCTYPE html>
<html lang="en">

<head> 
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>Qian Wen Chee - Iowa Liquor Sales</title>
  <link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.css" rel="stylesheet">
  <meta name="description" content="">
  <meta name="keywords" content="">

  <!-- Favicons -->
  <link href="assets/img/favicon.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Fonts --> 
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Raleway:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/aos/aos.css" rel="stylesheet">
  <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">
  <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">

  <!-- Main CSS File -->
  <link href="assets/css/main.css" rel="stylesheet">

  <!-- =======================================================
  * Template Name: Kelly
  * Template URL: https://bootstrapmade.com/kelly-free-bootstrap-cv-resume-html-template/
  * Updated: Aug 07 2024 with Bootstrap v5.3.3
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
</head>

<body class="services-page">

  <header id="header" class="header d-flex align-items-center light-background sticky-top">
    <div class="container-fluid position-relative d-flex align-items-center justify-content-between">

      <a href="index.html" class="logo d-flex align-items-center me-auto me-xl-0">
        <!-- Uncomment the line below if you also wish to use an image logo -->
        <!-- <img src="assets/img/logo.png" alt=""> -->
        <h1 class="sitename">Qian Wen Chee</h1>
      </a>

      <nav id="navmenu" class="navmenu">
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="about.html">About Me</a></li>
          <li><a href="resume.html">Resume</a></li>
          <li><a href="skills.html">Skills</a></li>
          <li class="dropdown"><a href="projects.html"><span>Projects</span> <i class="bi bi-chevron-down toggle-dropdown"></i></a>
            <ul>
              <li><a href="airturb.html">Predicting Air Turbulence</a></li>
              <li><a href="hdbresale.html">Singapore HDB Resale Prices</a></li>
              <li><a href="uselections.html">U.S. Presidential Elections</a></li>
              <li><a href="iowasales.html">Iowa Liquor Sales</a></li>
              <li><a href="aelp.html">The AELP</a></li>
              <li><a href="lexical.html">LexiCAL</a></li>
            </ul>
          </li>
          <li><a href="publications.html">Publications</a></li>
        </ul>
        <i class="mobile-nav-toggle d-xl-none bi bi-list"></i>
      </nav>

      <div class="header-social-links">
        <a href="https://www.linkedin.com/in/cheeqw/" class="linkedin"><i class="bi bi-linkedin"></i></a>
        <a href="https://github.com/qw-chee" class="github"><i class="bi bi-github"></i></a>
        <a href="https://www.researchgate.net/profile/Qian-Wen-Chee" class="researchgate"><i class="bi bi-researchgate"></i></a>
      </div>


    </div>
  </header>

  <main class="main">

    <!-- Skills Section -->
    <section id="services" class="services section">

      <!-- Section Title -->
      <div class="container section-title" data-aos="fade-up">
        <h2>Iowa Liquor Sales</h2>
        <p>This project uses PostgreSQL to analyse trends in the Iowa liquor sales database.</p>
      </div><!-- End Section Title -->

      <div class="container">

        <div class="row gy-4">
          
    <div class="container" data-aos="fade-up" data-aos-delay="100">
          <img src="assets/img/iowa.jpg" class="img-fluid">
      <br>
          <br><h3>Description</h3>
          <p>The Iowa liquor sales dataset contains the spirits purchase information of Iowa Class “E” liquor licensees by product and date of purchase from January 1, 2012 to current. The dataset can be used to analyze total spirits sales in Iowa of individual products at the store level.</p>

<p>Class E liquor license, for grocery stores, liquor stores, convenience stores, etc., allows commercial establishments to sell liquor for off-premises consumption in original unopened containers.</p>

      <p>This project uses PostgreSQL to analyse trends in the dataset, to facilitate understanding of liquor sales in Iowa.</p>

      <br>

      <h3>Data Source</h3>
      <p>The Iowa liquor sales dataset is available here: <a href="https://data.iowa.gov/Sales-Distribution/Iowa-Liquor-Sales/m3tr-qhgy/about_data">https://data.iowa.gov/Sales-Distribution/Iowa-Liquor-Sales/m3tr-qhgy/about_data</a></p>

      <br>
      <h3>SQL Queries</h3>
      <h6>1. How many products are there in the dataset?</h6>
      <pre><code class="language-sql">
        SELECT COUNT(item_no)
        FROM products;
      </code></pre>
      <strong>Result: 9977</strong>
      <br>
      <br><h6>2. Who are the top most diverse vendors (i.e. they have the highest number of distinct products)? How many different products do they have?</h6>
      <pre><code class="language-sql">
        SELECT vendor_name, COUNT(DISTINCT item_no)
        FROM products
        GROUP BY 1
        ORDER BY 2 DESC
        LIMIT 5;
      </code></pre>
      <strong>Result:</strong>
      <table>
  <table class="table table-bordered table-striped table-hover">
      <thead>
    <tr>
      <th>Vendor Name</th>
      <th>No. of Products</th>
    </tr>
  </thead>
  <tbody>
    <tr><td>Jim Beam Brands</td><td>925</td></tr>
    <tr><td>Diageo Americas</td><td>907</td></tr>
    <tr><td>Pernod Ricard USA / Austin Nichols</td><td>599</td></tr>
    <tr><td>Yahara Bay Distillers Inc.</td><td>579</td></tr>
    <tr><td>Heaven Hill Distilleries Inc.</td><td>388</td></tr>
  </tbody>
  </table>
      <br><h6>3. Which products sell the best by total number of unit sales? </h6>
      <pre><code class="language-sql">
        SELECT p.item_no, p.item_description, SUM(s.bottle_qty)
        FROM products p
        JOIN sales s
        ON
          p.item_no
          =
          s.item
        GROUP BY 1,2
        ORDER BY 3 DESC
        LIMIT 5;
      </code></pre>
      <strong>Result:</strong>
<table>
  <table class="table table-bordered table-striped table-hover">
      <thead>
    <tr>
      <th>Item No.</th>
      <th>Item Description</th>
      <th>Qty Sold</th>
    </tr>
  </thead>
  <tbody>
    <tr><td>11788</td><td>Black Velvet</td><td>828393</td></tr>
    <tr><td>36308</td><td>Hawkeye Vodka</td><td>500070</td></tr>
    <tr><td>43337</td><td>Captain Morgan Spiced Rum</td><td>483621</td></tr>
    <tr><td>36904</td><td>Mccormick Vodka Pet</td><td>393203</td></tr>
    <tr><td>35317</td><td>Barton Vodka</td><td>288425</td></tr>
  </tbody>
  </table>
      <br><h6>4. Which products sell the best by total dollar value of sales? </h6>
      <pre><code class="language-sql">
        SELECT p.item_no, p.item_description, SUM(s.total)
        FROM products p
        JOIN sales s
        ON
          p.item_no
          =
          s.item
        GROUP BY 1,2
        ORDER BY 3 DESC
        LIMIT 5;
      </code></pre>
      <strong>Result:</strong>
<table>
  <table class="table table-bordered table-striped table-hover">
    <thead>
    <tr>
      <th>Item No.</th>
      <th>Item Description</th>
      <th>Total Sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>11788</td>
      <td>Black Velvet</td>
      <td>$12,863,376.81</td>
    </tr>
    <tr>
      <td>43337</td>
      <td>Captain Morgan Spiced Rum</td>
      <td>$8,523,370.55</td>
    </tr>
    <tr>
      <td>26827</td>
      <td>Jack Daniels Old #7 Black Lbl</td>
      <td>$6,668,863.94</td>
    </tr>
    <tr>
      <td>11297</td>
      <td>Crown Royal Canadian Whisky</td>
      <td>$6,231,299.41</td>
    </tr>
    <tr>
      <td>36308</td>
      <td>Hawkeye Vodka</td>
      <td>$5,380,753.20</td>
    </tr>
  </tbody>
  </table>
        <br><h6>5. Which rum products have sales greater than $10,000?</h6>
      <pre><code class="language-sql">
        SELECT item, description, category_name, SUM(total)
        FROM sales
        WHERE category_name ILIKE '%rum%'
        GROUP BY 1,2,3
        Having SUM(total) > 10000
        ORDER BY 4 DESC;
      </code></pre>
      <strong>Result: 166 rum products</strong>
<table>
  <table class="table table-bordered table-striped table-hover">
     <thead>
    <tr>
      <th>Item No.</th>
      <th>Item Description</th>
      <th>Category</th>
      <th>Total Sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>43337</td>
      <td>Captain Morgan Spiced Rum</td>
      <td>SPICED RUM</td>
      <td>$8,523,370.55</td>
    </tr>
    <tr>
      <td>43338</td>
      <td>Captain Morgan Spiced Rum</td>
      <td>SPICED RUM</td>
      <td>$4,341,131.70</td>
    </tr>
    <tr>
      <td>1799</td>
      <td>Captain Morgan Spiced Barrel</td>
      <td>SPICED RUM</td>
      <td>$3,774,545.06</td>
    </tr>
    <tr>
      <td>43336</td>
      <td>Captain Morgan Original Spiced</td>
      <td>SPICED RUM</td>
      <td>$3,497,803.08</td>
    </tr>
    <tr>
      <td>43028</td>
      <td>Admiral Nelson Spiced Rum</td>
      <td>SPICED RUM</td>
      <td>$2,164,286.62</td>
    </tr>
  </tbody>
  </table>
  <br><h6>6. Which county sold the most amount of vodka during February 2014?</h6>
      <pre><code class="language-sql">
        SELECT county, SUM(bottle_qty)
        FROM sales
        WHERE category_name ILIKE '%vodka'
          AND DATE_PART ('year', date) = 2014
          AND DATE_PART ('month', date) = 2
        GROUP BY 1
        ORDER BY 2 DESC
        LIMIT 1;
      </code></pre>
      <strong>Result: Polk</strong>
  <br>
  <br><h6>7. Which counties were in the top 10 counties for vodka sales in any month in 2014?</h6>
      <pre><code class="language-sql">
        WITH monthly_rank AS (
          SELECT
            county,
            DATE_PART ('month', date) AS month,
            SUM(total) AS monthly_sales,
            RANK () OVER (PARTITION BY DATE_PART ('month', date) ORDER BY SUM(total)DESC) AS monthly_rank_number
          FROM sales
          WHERE category_name ILIKE '%vodka' AND DATE_PART ('year', date) = 2014
          GROUP BY 1,2
        )
        SELECT county, month, monthly_sales, monthly_rank_number
        FROM monthly_rank
        WHERE monthly_rank_number <= 10 AND month = 1
        ORDER BY 4;
      </code></pre>
      <strong>Result:</strong>
<table>
  <table class="table table-bordered table-striped table-hover">
      <thead>
    <tr>
      <th>County</th>
      <th>Month</th>
      <th>Vodka Sales</th>
      <th>Monthly Rank</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Polk</td>
      <td>1</td>
      <td>$2,188,692.56</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Linn</td>
      <td>1</td>
      <td>$975,547.22</td>
      <td>2</td>
    </tr>
    <tr>
      <td>Scott</td>
      <td>1</td>
      <td>$764,583.12</td>
      <td>3</td>
    </tr>
    <tr>
      <td>Johnson</td>
      <td>1</td>
      <td>$687,857.74</td>
      <td>4</td>
    </tr>
    <tr>
      <td>Black Hawk</td>
      <td>1</td>
      <td>$611,497.16</td>
      <td>5</td>
    </tr>
    <tr>
      <td>Pottawattamie</td>
      <td>1</td>
      <td>$425,965.76</td>
      <td>6</td>
    </tr>
    <tr>
      <td>Story</td>
      <td>1</td>
      <td>$358,245.36</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Dubuque</td>
      <td>1</td>
      <td>$348,632.82</td>
      <td>8</td>
    </tr>
    <tr>
      <td>Woodbury</td>
      <td>1</td>
      <td>$289,273.18</td>
      <td>9</td>
    </tr>
    <tr>
      <td>Cerro Gordo</td>
      <td>1</td>
      <td>$222,337.54</td>
      <td>10</td>
    </tr>
  </tbody>
  </table>

    <br><h6>8. How many times does a county appear in the “top 10 counties for vodka sales in a month” list over the course of 2014?</h6>
      <pre><code class="language-sql">
        WITH monthly_rank AS (
          SELECT
            county,
            DATE_PART ('month', date) AS month,
            SUM(total) AS monthly_sales,
            RANK () OVER (PARTITION BY DATE_PART ('month', date) ORDER BY SUM(total)DESC) AS monthly_rank_number
          FROM sales
          WHERE category_name ILIKE '%vodka' AND DATE_PART ('year', date) = 2014
          GROUP BY 1,2
        )
        SELECT county, COUNT(*)
        FROM monthly_rank
        WHERE monthly_rank_number <= 10
        GROUP BY 1
        ORDER BY 2 DESC;
      </code></pre>
      <strong>Result:</strong>
<table>
  <table class="table table-bordered table-striped table-hover">
    <thead>
    <tr>
      <th>County</th>
      <th>Number of Top 10s</th>
    </tr>
  </thead>
  <tbody>
    <tr><td>Black Hawk</td><td>12</td></tr>
    <tr><td>Dubuque</td><td>12</td></tr>
    <tr><td>Johnson</td><td>12</td></tr>
    <tr><td>Linn</td><td>12</td></tr>
    <tr><td>Polk</td><td>12</td></tr>
    <tr><td>Pottawattamie</td><td>12</td></tr>
    <tr><td>Scott</td><td>12</td></tr>
    <tr><td>Woodbury</td><td>11</td></tr>
    <tr><td>Story</td><td>10</td></tr>
    <tr><td>Cerro Gordo</td><td>7</td></tr>
    <tr><td>Dallas</td><td>6</td></tr>
    <tr><td>Des Moines</td><td>1</td></tr>
    <tr><td>Dickinson</td><td>1</td></tr>
  </tbody>
</table>
<br><h6>9. Which stores had the top 10 month-on-month growth rate?</h6>
      <pre><code class="language-sql">
        WITH store_monthly_sales AS (
          SELECT
            s.store,
            str.name,
            DATE_PART ('month', date) AS month,
            SUM(total) as monthly_sales
          FROM sales s
          JOIN stores str
          Using (store)
          GROUP BY 1,2,3
        )
        SELECT
          store,
          name,
          month,
          monthly_sales,
          LAG(monthly_sales, 1) OVER (PARTITION BY store ORDER BY month) AS prev_month_sales, 
          ROUND(((monthly_sales - LAG(monthly_sales, 1) OVER (PARTITION BY store ORDER BY month)) / LAG(monthly_sales, 1) OVER (PARTITION BY store ORDER BY month))*100, 2) AS month_on_month_perc
        FROM store_monthly_sales
        ORDER BY 6 DESC NULLS LAST
        LIMIT 10;
      </code></pre>
      <strong>Result:</strong>
<table>
  <table class="table table-bordered table-striped table-hover">
      <thead>
    <tr>
      <th>Store</th>
      <th>Store Name</th>
      <th>Month</th>
      <th>Monthly Sales</th>
      <th>Prev Month Sales</th>
      <th>Month-on-Month Growth</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2238</td>
      <td>Adventureland Inn</td>
      <td>5</td>
      <td>$27,526.38</td>
      <td>$883.24</td>
      <td>3016.52%</td>
    </tr>
    <tr>
      <td>4275</td>
      <td>Fareway Stores #980 / Knoxville</td>
      <td>9</td>
      <td>$41,674.59</td>
      <td>$2,925.30</td>
      <td>1324.63%</td>
    </tr>
    <tr>
      <td>4169</td>
      <td>Super Quick 2 / Hubbell</td>
      <td>11</td>
      <td>$12,794.70</td>
      <td>$985.92</td>
      <td>1197.74%</td>
    </tr>
    <tr>
      <td>4669</td>
      <td>Vom Fass / Des Moines</td>
      <td>10</td>
      <td>$7,231.01</td>
      <td>$649.24</td>
      <td>1013.77%</td>
    </tr>
    <tr>
      <td>4717</td>
      <td>Walgreens #05512 / Bettendorf</td>
      <td>8</td>
      <td>$14,064.95</td>
      <td>$1,412.70</td>
      <td>895.61%</td>
    </tr>
    <tr>
      <td>2667</td>
      <td>Hy-Vee Mainstreet</td>
      <td>3</td>
      <td>$77,712.78</td>
      <td>$7,878.87</td>
      <td>886.34%</td>
    </tr>
    <tr>
      <td>5058</td>
      <td>Kum & Go # 542 / Urbandale</td>
      <td>11</td>
      <td>$11,686.97</td>
      <td>$1,372.99</td>
      <td>751.21%</td>
    </tr>
    <tr>
      <td>5009</td>
      <td>New Pioneer Food Co-op</td>
      <td>8</td>
      <td>$11,661.63</td>
      <td>$1,423.98</td>
      <td>718.95%</td>
    </tr>
    <tr>
      <td>4899</td>
      <td>Graettinger Market</td>
      <td>7</td>
      <td>$9,321.60</td>
      <td>$1,172.52</td>
      <td>695.01%</td>
    </tr>
    <tr>
      <td>4598</td>
      <td>Quik Trip #501 / E Euclid DM</td>
      <td>5</td>
      <td>$30,868.46</td>
      <td>$4,166.58</td>
      <td>640.86%</td>
    </tr>
  </tbody>
  </table>
  <br><h6>10. Sort the stores in latitude order from most northernly to most southernly.</h6>
      <pre><code class="language-sql">
        SELECT store, name, split_part(split_part(store_address, '(', 2), ',', 1) AS latitude
        FROM stores
        ORDER BY 3 DESC
        LIMIT 5;
      </code></pre>
      <strong>Result:</strong>
<table>
  <table class="table table-bordered table-striped table-hover">
    <thead>
    <tr>
      <th>Store No.</th>
      <th>Store Name</th>
      <th>Latitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>3596</td>
      <td>Laddy’s Bar And Grill</td>
      <td>43.49114240400007</td>
    </tr>
    <tr>
      <td>4030</td>
      <td>Buy Rite Foods</td>
      <td>43.45480634900008</td>
    </tr>
    <tr>
      <td>3914</td>
      <td>Market Street Market</td>
      <td>43.45480634900008</td>
    </tr>
    <tr>
      <td>4006</td>
      <td>Larchwood Offsale</td>
      <td>43.45384534900006</td>
    </tr>
    <tr>
      <td>4904</td>
      <td>Larchwood Quick Stop</td>
      <td>43.45355826500003</td>
    </tr>
  </tbody>
</table>
  
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-sql.min.js"></script>
        
      <br><h5><a href="https://github.com/qw-chee/iowa_liquor">Explore the project's GitHub repository here</a></h5>

    </div>    
   </div>
  </div>

    </section><!-- /Services Section -->

  </main>

  <footer id="footer" class="footer light-background">

    <div class="container">
      <div class="copyright text-center ">
        <p>© <span>Copyright 2025</span> <strong class="px-1 sitename">Qian Wen Chee.</strong> <span>All Rights Reserved.<br></span></p>
      </div>
      <div class="social-links d-flex justify-content-center">
        <a href="https://www.linkedin.com/in/cheeqw/" class="linkedin"><i class="bi bi-linkedin"></i></a>
        <a href="https://github.com/qw-chee" class="github"><i class="bi bi-github"></i></a>
      </div>
    </div>

  </footer>

  <!-- Scroll Top -->
  <a href="#" id="scroll-top" class="scroll-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

  <!-- Preloader -->
  <div id="preloader"></div>

  <!-- Vendor JS Files -->
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>
  <script src="assets/vendor/aos/aos.js"></script>
  <script src="assets/vendor/waypoints/noframework.waypoints.js"></script>
  <script src="assets/vendor/purecounter/purecounter_vanilla.js"></script>
  <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
  <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
  <script src="assets/vendor/imagesloaded/imagesloaded.pkgd.min.js"></script>
  <script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>

  <!-- Main JS File -->
  <script src="assets/js/main.js"></script>

</body>

</html>
